FROM node:12
ARG GRAPHQL_HTTP_URI_ARG
ARG GRAPHQL_WS_URI_ARG
ARG AUTH_URI_ARG
ENV GRAPHQL_HTTP_URI=$GRAPHQL_HTTP_URI_ARG
ENV GRAPHQL_WS_URI=$GRAPHQL_WS_URI_ARG
ENV AUTH_URI=$AUTH_URI_ARG
WORKDIR /app
COPY ["package.json", "package-lock.json*", "./"]
RUN npm install --production
COPY . .
RUN npm run build
EXPOSE 8080
CMD npm start